<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Russia方块</title>
    <script type="text/javascript" src="russiaRect/pluralism.js"></script>
    <script type="text/javascript">
        window.addEventListener("load",function (event) {
            clearMp3 = document.getElementById("clearMp3");
            myCanvas = document.getElementById("drawGames");
            canvas2d = myCanvas.getContext("2d");
            initDataRect();
            myCanvas.setAttribute("width",document.body.clientWidth*0.6);
            myCanvas.setAttribute("height",window.screen.availHeight);
            myCanvas.style.backgroundColor="black";
            myCanvas.style.marginLeft=Math.floor(document.body.clientWidth*0.2)+"px";
            dataWidth = myCanvas.width / dataRect[0].length;
            dataHeight = myCanvas.height / dataRect.length;
            drawData();
            timeRun = setInterval(timeRuning,1000);
        },true);
        //窗体大不改变事件
        window.onresize=function(event) {
            myCanvas.setAttribute("width",document.body.clientWidth*0.6);
            myCanvas.style.marginLeft=Math.floor(document.body.clientWidth*0.2)+"px";
            dataWidth = myCanvas.width / dataRect[0].length;
            dataHeight = myCanvas.height / dataRect.length;
            drawData();
        };
        window.onkeydown=function(event){
            switch (event.key) {
                case "w":
                    chameleon();
                    break;
                case "s":
                    downData();
                    break;
                case "a":
                    moveLeft();
                    break;
                case "d":
                    moveRight();
                    break;
            }
        };
        //滚动监听这个不用
        window.onscroll = function (event) {
            if(getScrollTop() + getWindowHeight() == getScrollHeight()){

            }
        };
        //获得可用视窗大小
        function getWindowHeight(){
            var windowHeight = 0;
            if(document.compatMode == "CSS1Compat"){
                windowHeight = document.documentElement.clientHeight;
            }else{
                windowHeight = document.body.clientHeight;
            }
            return windowHeight;
        };
        //获得滚动的总高度
        function getScrollHeight(){
            var scrollHeight = 0, bodyScrollHeight = 0, documentScrollHeight = 0;
            if(document.body){
                bodyScrollHeight = document.body.scrollHeight;
            }
            if(document.documentElement){
                documentScrollHeight = document.documentElement.scrollHeight;
            }
            scrollHeight = (bodyScrollHeight - documentScrollHeight > 0) ? bodyScrollHeight : documentScrollHeight;
            return scrollHeight;
        };
        //获得滚动条当前滚动的高度(不包括滚动条的高度)
        function getScrollTop(){
            var scrollTop = 0, bodyScrollTop = 0, documentScrollTop = 0;
            if(document.body){
                bodyScrollTop = document.body.scrollTop;
            }
            if(document.documentElement){
                documentScrollTop = document.documentElement.scrollTop;
            }
            scrollTop = (bodyScrollTop - documentScrollTop > 0) ? bodyScrollTop : documentScrollTop;
            return scrollTop;
        };
    </script>
</head>
<body>
<canvas id="drawGames">
    浏览器不支持canvas
</canvas>
<audio src="russiaRect/clear.mp3" id="clearMp3">
    您的浏览器不支持 audio 标签
</audio>
</body>
</html>